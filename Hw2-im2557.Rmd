---
title: "Hw2"
author: 'IRENE MARTINEZ MORATA (UNI: im2557)'
date: "10/5/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readxl)
getwd()
```

## Problem 1.1

```{r Problem 1.1}
problem1 <- read_excel("Trash-Wheel-Collection-Totals-7-2020-2.xlsx",
                       sheet = "Mr. Trash Wheel",
                       range = "A2:N534",
                       ) %>%
janitor::clean_names() %>% 
drop_na(dumpster) %>% 
mutate(sports_balls = round(sports_balls, 0))

problem1a <- problem1 %>% 
  filter(year == "2019")
#summary(problem1a)
       
```

## Problem 1.2

```{r Problem 1.2}
prec18 <- read_excel("Trash-Wheel-Collection-Totals-7-2020-2.xlsx",
                       sheet = "2018 Precipitation",
                       range = "A2:B14") %>%
  janitor::clean_names() %>% 
  mutate(month = as.numeric(month),
         total = as.numeric(total)) %>% 
   mutate(year = 2018)
#summary(prec18)

prec19 <- read_excel("Trash-Wheel-Collection-Totals-7-2020-2.xlsx",
                       sheet = "2019 Precipitation",
                       range = "A2:B14") %>% 
  janitor::clean_names() %>% 
  mutate(month = as.numeric(month), 
         total = as.numeric(total)) %>%
  drop_na() %>% 
  mutate(year = 2019)

prob1.2 = 
  bind_rows(prec18, prec19) %>% 
  mutate(month = month.name[as.numeric(month)])
```
Data description:In the first dataset, the wheel collection totals (labeled as Problem 1) was composed of  composed of 14 columns, some of the variables included dumpster, month, year, glass bottles and sport balls, among others. The median sports_balls in 209 was 9.00 and the mean was 10.3 

The second and third datasets (labelled as problem 1.2 and 1.3) are the precipitation data for 2018 and 2019 per month.
The median precipitation in 2018 was 5.45 and the mean was 5.86.

## Problem 2

```{r Problem2, echo=TRUE}
Prob2.1 <- read_csv("pols-month.csv") %>% 
  separate(mon, into = c("year", "month", "day")) %>% 
  mutate(month = month.name[as.numeric(month)]) %>% 
  mutate(president = ifelse(prez_dem == 1, "dem", "gop")) %>% 
  select(-prez_dem, -prez_gop, -day) %>% 
  mutate(year = as.numeric(year)) 


Prob2.2 <- read_csv("snp.csv") %>% 
  separate(date, into = c("month", "day", "year")) %>% 
  mutate(month = month.name[as.numeric(month)]) %>% 
  select(-day) %>% 
  relocate(year, month) %>% 
  mutate(year = case_when(
  year >= 50 ~ paste0("19", year), 
  year <= 15 ~ paste0("20", year)),
  year = as.numeric(year))

Prob2.3 <- read_csv("unemployment.csv") %>% 
  janitor::clean_names() %>% 
  pivot_longer(
    jan:dec, 
    names_to = "month",
    values_to = "unemployment_rate"
  ) %>% 
  mutate(
    year = as.numeric(year),
    month = replace(month, month == "jan", "January"),
    month = replace(month, month == "feb", "February"),
    month = replace(month, month == "mar", "March"),
    month = replace(month, month == "apr", "April"),
    month = replace(month, month == "may", "May"),
    month = replace(month, month == "jun", "June"),
    month = replace(month, month == "jul", "July"),
    month = replace(month, month == "aug", "August"),
    month = replace(month, month == "sep", "September"),
    month = replace(month, month == "oct", "October"),
    month = replace(month, month == "nov", "November"),
    month = replace(month, month == "dec", "December"))

  
Full_prob2 <- inner_join(Prob2.1, Prob2.2, by = c("year", "month"))

Full_prob2.1 <- inner_join(Full_prob2, Prob2.3, by = c("year", "month"))

#summary(Prob2.1)
#summary(Prob2.2)
#summary(Prob2.3)
#summary(Full_prob2.1)

```
The first database (coded as Prob2.1) contained 822 observations with information about the distribution of representatives, senators and presidents from the republican or democrat parties at selected time points from 1947 to 2015. 
The second database (coded as Prob2.2) contained 787 observations with information on gross domestic product (GDP) from 1950 until 2015. The mean GDP in such time frame was 474.89 and the median 138.53.
The third database (coded as Prob2.3) contained 816 observations for unemployment rate at different months from 1948 until 2015. The mean unemployment rate was 5.83 and the median 5.60-

In total, after combining the data sets, 786 observations had data across all the three data sets, the time frame of the data observations was from 1950 to 2015. The set of variables included: year, month of the observation, president party, democrat senators and governors, republican senators and governors, GDP, and unemployment rate among others. The median GDP across observations was 137.26, and the median unemployment rate was 5.6

## Problem 3

```{r Problem 3}
Prob3 <- read_csv("Popular_Baby_Names.csv") %>% 
janitor::clean_names() %>% 
  mutate(ethnicity = str_to_lower(ethnicity)) %>% 
  mutate(childs_first_name = str_to_lower(childs_first_name)) %>% 
  mutate(gender = str_to_lower(gender),
         ethnicity = as.character(ethnicity),
         ethnicity = recode(ethnicity, "asian and paci" = "asian and pacific islander", "hispanic" = "hispanic", "black non hisp" = "black non hispanic", "white non hisp" = "white non hispanic")
        )  %>% 
distinct() 

  
Prob3.1 <- Prob3 %>%
  filter(childs_first_name == "olivia" & gender == "female") %>% 
  select(-gender, -childs_first_name, -count) %>% 
pivot_wider(names_from = year_of_birth, values_from = rank)

print(Prob3.1)

Prob3.2 <- Prob3 %>% 
  filter(rank == "1" & gender == "male") %>% 
  select(-gender,-count, -rank) %>% 
  pivot_wider(names_from = year_of_birth, values_from = childs_first_name)

print(Prob3.2)

plot <- Prob3 %>% 
  filter(ethnicity == "white non hispanic" & year_of_birth == "2016") %>% 
  ggplot(aes(x = rank, y = count)) + geom_point()

print(plot)
```
